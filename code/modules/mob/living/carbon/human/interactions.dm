/**********************************
*******Interactions code by HONKERTRON feat TestUnit********
**Contains a lot ammount of ERP and MEHANOYEBLYA**
***********************************/

/mob/living/carbon/human/MouseDrop_T(mob/M as mob, mob/user as mob)
	if(M == src || src == usr || M != usr)		return
	if(usr.restrained())		return

	var/mob/living/carbon/human/H = usr
	H.partner = src
	make_interaction(machine)

/mob/proc/make_interaction()
	return

//Distant interactions
/mob/living/carbon/human/verb/interact(mob/M as mob)
	set name = "Interact"
	set category = "IC"

	if (istype(M, /mob/living/carbon/human) && usr != M)
		partner = M
		make_interaction(machine)

/datum/species/human
	genitals = 1
	anus = 1

/datum/species/plasmaman
	anus = 0

/datum/species/kidan
	anus = 0

/datum/species/wryn
	anus = 0

/datum/species/unathi
	genitals = 1
	anus = 1

/datum/species/Tajara
	genitals = 1
	anus = 1

/datum/species/vulpkanin
	genitals = 1
	anus = 1

/datum/species/human/skrell
	genitals = 0
	anus = 1

/datum/species/monkey
	genitals = 1
	anus = 1

/datum/species/monkey/skrell
	genitals = 0
	anus = 1

/datum/species/human/machine
	genitals = 0
	anus = 0 //kiss my metal ass

/datum/species/human/diona
	genitals = 0
	anus = 0

/datum/species/human/vatgrown
	genitals = 1
	anus = 1

/datum/species/human/spacer
	genitals = 1
	anus = 1

/datum/species/human/gravworlder
	genitals = 1
	anus = 1

/datum/species/teshari
	genitals = 1
	anus = 1

/datum/species/akula
	genitals = 1
	anus = 1

/datum/species/sergal
	genitals = 1
	anus = 1

/datum/species/nevrean
	genitals = 0
	anus = 1

/datum/species/hi_zoxxen
	genitals = 1
	anus = 1

/datum/species/fl_zorren
	genitals = 1
	anus = 1

/datum/species/xenohybrid
	genitals = 1
	anus = 1

/datum/species/shapeshifter/promethean
	genitals = 1
	anus = 1

/datum/species/spider
	genitals = 1
	anus = 1

/datum/species/custom
	genitals = 1
	anus = 1

/datum/species/harpy
	genitals = 1
	anus = 1

/mob/living/carbon/human/proc/is_nude()
	return (!wear_suit && !w_uniform) ? 1 : 0 //TODO: Nudity check for underwear

/mob/living/carbon/human/make_interaction()
	set_machine(src)

	var/mob/living/carbon/human/H = usr
	var/mob/living/carbon/human/P = H.partner
	var/obj/item/organ/external/temp = H.organs_by_name["r_hand"]
	var/hashands = (temp && temp.is_usable())
	if (!hashands)
		temp = H.organs_by_name["l_hand"]
		hashands = (temp && temp.is_usable())
	temp = P.organs_by_name["r_hand"]
	var/hashands_p = (temp && temp.is_usable())
	if (!hashands_p)
		temp = P.organs_by_name["l_hand"]
		hashands = (temp && temp.is_usable())
	var/mouthfree = !((H.head && (H.head.flags & HIDEFACE)) || (H.wear_mask && (H.wear_mask.flags & HIDEFACE)))
	var/mouthfree_p = !( (P.head && (P.head.flags & HIDEFACE)) || (P.wear_mask && (P.wear_mask.flags & HIDEFACE)))
	var/haspenis = ((H.gender == MALE && H.potenzia > -1 && H.species.genitals))
	var/haspenis_p = ((P.gender == MALE && P.potenzia > -1  && P.species.genitals))
	var/hasvagina = (H.gender == FEMALE && H.species.genitals && H.species.name != "Stok" && H.species.name != "Teshari")
	var/hasvagina_p = (P.gender == FEMALE && P.species.genitals && P.species.name != "Stok" && P.species.name != "Teshari")
	var/hasanus_p = P.species.anus
	var/isnude = H.is_nude()
	var/isnude_p = P.is_nude()

	H.lastfucked = null
	H.lfhole = ""

	var/dat = "<B><HR><FONT size=3>INTERACTIONS - [H.partner]</FONT></B><BR><HR>"
	var/ya = "&#1103;"

	dat +=  {"Х <A href='?src=\ref[src];interaction=bow'>ќтвесить поклон.</A><BR>"}
	//if (Adjacent(P))
	//	dat +=  {"Х <A href='?src=\ref[src];interaction=handshake'>ѕоприветствовать.</A><BR>"}
	//else
	//	dat +=  {"Х <A href='?src=\ref[src];interaction=wave'>ѕоприветствовать.</A><BR>"}
	if (hashands)
		dat +=  {"<font size=3><B>–уки:</B></font><BR>"}
		if (Adjacent(P))
			dat +=  {"Х <A href='?src=\ref[src];interaction=handshake'>ѕожать руку.</A><BR>"}
			dat +=  {"Х <A href='?src=\ref[src];interaction=hug'>ќбнимашки!</A><BR>"}
			dat +=  {"Х <A href='?src=\ref[src];interaction=cheer'>ѕохлопать по плечу</A><BR>"}
			dat +=  {"Х <A href='?src=\ref[src];interaction=five'>ƒать п[ya]ть.</A><BR>"}
			if (hashands_p)
				dat +=  {"Х <A href='?src=\ref[src];interaction=give'>ѕередать предмет.</A><BR>"}
			dat +=  {"Х <A href='?src=\ref[src];interaction=slap'><font color=red>ƒать пощечину!</font></A><BR>"}
			if (isnude_p)
				if (hasanus_p)
					dat += {"Х <A href='?src=\ref[src];interaction=assslap'>Ўлепнуть по заднице</A><BR>"}
				if (hasvagina_p)
					dat += {"Х <A href='?src=\ref[src];interaction=fingering'>ѕросунуть пальчик...</A><BR>"}
				if (haspenis_p)
					dat += {"Х <A href='?src=\ref[src];interaction=jerk'>ѕодрочить</A><BR>"}
			if ((P.species.name == "Tajara") || (P.species.name == "Vulpkanin") || (P.species.name == "Flatland Zorren") || (P.species.name == "Highlander Zorren") || (P.species.name == "Sergal") || (P.species.name == "Vox") || (P.species.name == "Nevrean") || (P.species.name == "Rapala") || (P.species.name == "Teshari") || (P.species.name == "Unathi"))
				dat +=  {"Х <A href='?src=\ref[src];interaction=pull'><font color=red>ƒЄрнуть за хвост!</font></A><BR>"}
				if(P.can_inject(H, 1))
					dat +=  {"Х <A href='?src=\ref[src];interaction=pet'>ѕогладить.</A><BR>"}
			dat +=  {"Х <A href='?src=\ref[src];interaction=knock'><font color=red>ƒать подзатыльник.</font></A><BR>"}
		dat +=  {"Х <A href='?src=\ref[src];interaction=fuckyou'><font color=red>ѕоказать средний палец.</font></A><BR>"}
		dat +=  {"Х <A href='?src=\ref[src];interaction=threaten'><font color=red>ѕогрозить кулаком.</font></A><BR>"}

	if (mouthfree && H.species.name != "Diona")
		dat += {"<font size=3><B>Ћицо:</B></font><BR>"}
		dat += {"Х <A href='?src=\ref[src];interaction=kiss'>ѕоцеловать.</A><BR>"}
		if (Adjacent(P))
			if (mouthfree_p)
				dat += {"Х <A href='?src=\ref[src];interaction=lick'>Ћизнуть в щеку.</A><BR>"}
			if (isnude_p)
				if (haspenis_p)
					dat += {"Х <A href='?src=\ref[src];interaction=blowjob'><font color=purple>—делать минет.</font></A><BR>"}
				if (hasvagina_p)
					dat += {"Х <A href='?src=\ref[src];interaction=vaglick'><font color=purple>¬ылизать.</font></A><BR>"}
				if (hasanus_p && P.species.name != "Diona")
					dat += {"Х <A href='?src=\ref[src];interaction=asslick'><font color=purple>ќтполировать черный ход?!</font></A><BR>"}
			dat +=  {"Х <A href='?src=\ref[src];interaction=spit'><font color=red>ѕлюнуть.</font></A><BR>"}
		dat +=  {"Х <A href='?src=\ref[src];interaction=tongue'><font color=red>ѕоказать [ya]зык.</font></A><BR>"}

	if (Adjacent(P) && isnude && P.species.name != "Diona")
		if (haspenis && hashands)
			dat += {"<font size=3><B>„лен:</B></font><BR>"}
			if (hasvagina_p && isnude_p && P.species.name != "Teshari")
				dat += {"Х <A href='?src=\ref[src];interaction=vaginal'><font color=purple>“рахнуть вагинально.</font></A><BR>"}
			if (hasanus_p && isnude_p)
				dat += {"Х <A href='?src=\ref[src];interaction=anal'><font color=purple>“рахнуть анально.</font></A><BR>"}
			if (mouthfree_p)
				dat += {"Х <A href='?src=\ref[src];interaction=oral'><font color=purple>“рахнуть орально.</font></A><BR>"}
	if (isnude && hashands)
		if (hasvagina)
			dat += {"<font size=3><B>Ћоно:</B></font><BR>"}
			if (isnude_p && haspenis_p && usr.loc == H.partner.loc)
				dat += {"Х <A href='?src=\ref[src];interaction=mount'><font color=purple>ќседлать</font></A><BR>"}
				dat += {"Х <A href='?src=\ref[src];interaction=rub'><font color=purple>ѕотеретьс[ya]</font></A><BR>"}
			if (mouthfree_p && usr.loc == H.partner.loc)
				dat += {"Х <A href='?src=\ref[src];interaction=facesitting'><font color=purple>—есть на лицо</font></A><BR>"}
			if (mouthfree_p && (Adjacent(P) || (usr.loc == H.partner.loc)))
				dat += {"Х <A href='?src=\ref[src];interaction=forcelick'><font color=purple>«аставить отлизывать</font></A><BR>"}

	var/datum/browser/popup = new(usr, "interactions", "Interactions", 340, 480)
	popup.set_content(dat)
	popup.open()

//INTERACTIONS
/mob/living/carbon/human
	var/mob/living/carbon/human/partner
	var/mob/living/carbon/human/lastfucked
	var/lfhole
	var/potenzia = 10
	var/resistenza = 200
	var/lust = 0
	var/erpcooldown = 0
	var/multiorgasms = 0
	var/lastmoan

mob/living/carbon/human/proc/cum(mob/living/carbon/human/H as mob, mob/living/carbon/human/P as mob, var/hole = "floor")
	var/message = "кончает на пол!"
	var/ya = "&#255;"
	var/turf/T

	if (H.gender == MALE)
		var/datum/reagent/blood/source = H.dna.b_type
		if (P)
			T = get_turf(P)
		else
			T = get_turf(H)
		if (H.multiorgasms < H.potenzia)
			var/obj/effect/decal/cleanable/cum/C = new(T)
			// Update cum information.
			C.blood_DNA = list()
			if(source.data["blood_type"])
				C.blood_DNA[source.data["blood_DNA"]] = source.data["blood_type"]
			else
				C.blood_DNA[source.data["blood_DNA"]] = "O+"

		if (H.species.genitals)
			if (hole == "mouth" || H.zone_sel.selecting == "mouth")
				message = pick("кончает [P] в рот.", "целитс[ya] в лицо [P], стрел[ya]ет тугой струЄй малафьи, но промахиваетс[ya].", "разбрызгивает сем[ya] на лицо [P].", "кончает на пол.")

			else if (hole == "vagina")
				message = pick("кончает в [P]", "резко выт[ya]гивает член из [P], а затем спускает на пол.", "проникает в [P] последний раз, затем содрагаетс[ya]. —перма медленно вытекает из щели [P].")

			else if (hole == "anus")
				message = pick("кончает [P] в зад.", "выдергивает член из [P], а затем обильно кончает на [P.identifying_gender == MALE ? "его" : "еЄ"] попку.", "выт[ya]гивает член из задницы [P] и сразу же спускает на пол.")

			else if (hole == "floor")
				message = "кончает на пол!"

		else
			message = pick("извиваетс[ya] в приступе оргазма", "прикрывает глаза и мелко дрожит", "содрагаетс[ya], а затем резко расслабл[ya]етс[ya]", "замирает, закатив глаза")

		playsound(loc, "honk/sound/interactions/final_m[rand(1, 5)].ogg", 70, 1, frequency = get_age_pitch())

		H.visible_message("<B>[H] [message]</B>")
		if (istype(P.loc, /obj/structure/closet))
			P.visible_message("<B>[H] [message]</B>")
		H.lust = 5
		H.resistenza += 50

	else
		message = pick("извиваетс[ya] в приступе оргазма", "прикрывает глаза и мелко дрожит", "содрагаетс[ya], а затем резко расслабл[ya]етс[ya]", "замирает, закатив глаза")
		H.visible_message("<B>[H] [message].</B>")
		if (istype(P.loc, /obj/structure/closet))
			P.visible_message("<B>[H] [message].</B>")
		playsound(loc, "honk/sound/interactions/final_f[rand(1, 3)].ogg", 90, 1, frequency = get_age_pitch())
		var/delta = pick(20, 30, 40, 50)
		src.lust -= delta

	H.druggy = 60
	H.multiorgasms += 1
	H.erpcooldown = 0
	H.lust = 0

mob/living/carbon/human/proc/fuck(mob/living/carbon/human/H as mob, mob/living/carbon/human/P as mob, var/hole)
	var/ya = "&#255;"
	var/message = ""

	switch(hole)

		if("vaglick")

			message = pick("вылизывает [P].", "отлизывает [P].")
			if (prob(35))
				switch(P.species.name)
					if("Human", "Vatborn", "Custom Species", "Rapala", "Vasilissan", "Akula", "Promethean", "Unathi")
						message = pick("вылизывает [P].", "полирует промежность [P] [ya]зыком.", "отлизывает [P].", "ласкает [P] [ya]зычком.", "погружает свой [ya]зык в [P]", "играетс[ya] с [P] [ya]зычком", "медленно проводит [ya]зыком вдоль промежности [P]")
					if("Tajara", "Vulpkanin", "Flatland Zorren", "Highlander Zorren", "Sergal")
						message = pick("вылизывает [P].", "полирует промежность [P] [ya]зыком.", "отлизывает [P].", "ласкает [P] [ya]зычком.", "погружает свой [ya]зык в [P]", "играетс[ya] с [P] [ya]зычком", "медленно проводит [ya]зыком вдоль промежности [P]")

			if (H.lastfucked != P || H.lfhole != hole)
				H.lastfucked = P
				H.lfhole = hole

			if (H.lust < 6)
				H.lust += 6
			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message]</B></font>")
				P.lust += 10
			else
				H.visible_message("<font color=purple>[H] [message]</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message]</font>")
			if (P.stat != DEAD && P.stat != UNCONSCIOUS)
				P.lust += 10
				if (P.lust >= P.resistenza)
					P.cum(P, H)
					message = pick("¬ы чувствуете, как вагинальные мышцы [P] начинают резко сокращатьс[ya].", "¬ы чувствуете, как в ваш рот попадает некоторое количество э[ya]кул[ya]та [P] в процессе оргазма.", "¬ы чувствуете, как влажна[ya] киска [P] резко сжимает ваш [ya]зычок внутри себ[ya].", "¬ы чувствуете, как всЄ внутри [P] сжимаетс[ya], а еЄ клитор начинает пульсировать.", "¬ы чувствуете, как [P] кончает вам в рот струйкой э[ya]кул[ya]та, оргазмиру[ya].")
					to_chat(H, message)
				else
					P.moan()
			H.do_fucking_animation(P)
			playsound(loc, "honk/sound/interactions/bj[rand(1, 11)].ogg", 50, 1, -1)

		if("facesitting")

			message = pick("елозит вагиной по лицу [P].", "сношает лицо [P].")
			if (prob(35))
				message = pick("трахает личико [P], провод[ya] по нему киской.", "полирует [ya]зык [P] своей промежностью, устроившись на [P.identifying_gender==FEMALE ? "еЄ" : "его"] лице.", "засовывает нос [P] промеж половых губ и Єрзает на нЄм.", "крепко жмЄтс[ya] к лицу [P] промежностью, выгиба[ya] спину.", "насилует лицо [P] быстрыми движени[ya]ми таза.", "играетс[ya] с ротиком [P], елоз[ya] по нему влагалищем.", "медленно проводит промежностью по лицу [P].", "размазывает свои соки по физиономии [P] движени[ya]ми таза.")

			if (H.lastfucked != P || H.lfhole != hole)
				message = pick("м[ya]гко садитс[ya] [P] на лицо.", "грубо насаживаетс[ya] на лицо [P].", "садитс[ya] на лицо [P], упира[ya]сь горошинкой клитора [P.identifying_gender==FEMALE ? "ей" : "ему"] под нос.", "седлает лицо [P] своей влажной промежностью.")
				H.lastfucked = P
				H.lfhole = hole

			if (P.lust < 6)
				P.lust += 6
			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message]</B></font>")
				H.lust += 10
			else
				H.visible_message("<font color=purple>[H] [message]</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message]</font>")
			if (H.stat != DEAD && H.stat != UNCONSCIOUS)
				H.lust += 10
				if (H.lust >= H.resistenza)
					H.cum(H, P)
					timeofact = world.time
					message = pick("¬ы чувствуете, как вагинальные мышцы [H] начинают резко сокращатьс[ya].", "¬ы чувствуете, как в ваш рот попадает некоторое количество э[ya]кул[ya]та [H] в процессе оргазма.", "¬ы чувствуете, как влажна[ya] киска [H] резко сжимаетс[ya] на вашем лице.", "¬ы чувствуете, как всЄ внутри [H] сжимаетс[ya], а еЄ клитор начинает пульсировать.", "¬ы чувствуете, как [H] кончает вам на лицо струйкой э[ya]кул[ya]та, оргазмиру[ya].")
					to_chat(P, message)
				else
					H.moan()
			H.do_fucking_animation(P)
			playsound(loc, "honk/sound/interactions/champ_fingering.ogg", 50, 1, -1)

		if("forcelick")

			message = pick("заставл[ya]ет [P] отлизывать.", "принуждает [P] вылизывать лоно.")
			if (prob(35))
				message = pick("сильно прижимает голову [P] к себе.", "трахает рот и нос [P], работа[ya] тазом.", "насилует физиономию [P], вцепившись в [P.identifying_gender==FEMALE ? "еЄ" : "его"] голову.", "задерживает голову [P] у своего влагалища, наслажда[ya]сь работой [ya]зыка.", "грубо сжимает пальцы на голове [P], когда [P.identifying_gender==FEMALE ? "еЄ" : "его"] [ya]зык погружаетс[ya] глубже.")

			if (H.lastfucked != P || H.lfhole != hole)
				message = pick("м[ya]гко наклон[ya]ет [P] к своей писечке.", "грубо хватает голову [P] и прислон[ya]ет к своей промежности.", "наклон[ya]ет лицо [P], погружа[ya] [P.identifying_gender==FEMALE ? "еЄ" : "его"] нос в свою мокренькую киску.", "прислон[ya]ет рот [P] к своей влажной промежности.")
				H.lastfucked = P
				H.lfhole = hole

			if (P.lust < 6)
				P.lust += 6
			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message]</B></font>")
				H.lust += 10
			else
				H.visible_message("<font color=purple>[H] [message]</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message]</font>")
			if (H.stat != DEAD && H.stat != UNCONSCIOUS)
				H.lust += 10
				if (H.lust >= H.resistenza)
					H.cum(H, P)
					timeofact = world.time
					message = pick("¬ы чувствуете, как вагинальные мышцы [P] начинают резко сокращатьс[ya].", "¬ы чувствуете, как в ваш рот попадает некоторое количество э[ya]кул[ya]та [P] в процессе оргазма.", "¬ы чувствуете, как влажна[ya] киска [P] резко сжимает ваш [ya]зычок внутри себ[ya].", "¬ы чувствуете, как всЄ внутри [P] сжимаетс[ya], а еЄ клитор начинает пульсировать.", "¬ы чувствуете, как [P] кончает вам в рот струйкой э[ya]кул[ya]та, оргазмиру[ya].")
					to_chat(P, message)
			else
				H.moan()
			H.do_fucking_animation(P)
			playsound(loc, "honk/sound/interactions/bj[rand(1, 11)].ogg", 50, 1, -1)

		if("fingering")

			message = pick("вводит два пальца в вагину [P].", "трахает [P] пальцами.")
			if (prob(35))
				switch(P.species.name)
					if("Human", "Vatborn", "Custom Species", "Rapala", "Vasilissan", "Akula", "Promethean")
						message = pick("вводит два пальца в вагину [P].", "теребит горошину [P].", "тычет пальцами [P].", "ласкает [P] пальчиками.", "нежно поглаживает промежность [P].", "погружает пальцы глубоко в [P], ласка[ya] еЄ изнутри.", "изучает глубины [P].")
					if("Tajara", "Vulpkanin", "Flatland Zorren", "Highlander Zorren", "Sergal")
						message = pick("вводит два пальца в пушистую вагину [P].", "теребит горошину [P].", "тычет пальцами [P].", "ласкает [P] пальчиками.", "нежно поглаживает промежность [P].", "погружает пальцы глубоко в [P], ласка[ya] еЄ изнутри.", "изучает глубины [P].")

			if (H.lastfucked != P || H.lfhole != hole)
				H.lastfucked = P
				H.lfhole = hole

			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message]</B></font>")
				P.lust += 8
			else
				H.visible_message("<font color=purple>[H] [message]</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message]</font>")
			if (P.stat != DEAD && P.stat != UNCONSCIOUS)
				P.lust += 8
				if (P.lust >= P.resistenza)
					P.cum(P, H)
					message = pick("¬ы чувствуете, как вагинальные мышцы [P] начинают резко сокращатьс[ya] вокруг ваших пальцев.", "¬ы чувствуете, как ребристые стенки [P] крепко сжимают ваши промокшие пальцы.", "¬ы чувствуете, как влажна[ya] киска [P] резко сжимает ваши пальцы внутри себ[ya].", "¬ы чувствуете, что вашим пальцам становитс[ya] тесно внутри гор[ya]чей писечки [P].", "¬ы чувствуете, как по внутренней стороне вашей ладони стекает тЄпла[ya] струйка э[ya]кул[ya]та [P].")
					to_chat(H, message)
				else
					P.moan()
			playsound(loc, "honk/sound/interactions/champ_fingering.ogg", 50, 1, -1)
			H.do_fucking_animation(P)

		if("jerk")

			message = pick("плюЄт на инструмент [P] и стимулирует его возвратно-поступательными движени[ya]ми.", "дрочит орган [P] в быстром темпе.", "медленно ласкает член [P] пальчиками.", "надрачивает [P] кулачком.", "дрочит член [P], заключив его в колечко из двух пальцев.", "медленно стимулирует орган [P].", "дрочит [P], обхватив его член рукой.", "надрачивает член [P].", "поглаживает головку члена [P] большим пальцем.", "дЄргает половой орган [P].", "передЄргивает [P].", "дрочит [P].")

			if (H.lastfucked != P || H.lfhole != hole)
				message = pick("м[ya]гко обхватывает член [P] рукой.", "берЄт член [P] в руку.", "начинает надрачивать [P].")
				H.lastfucked = P
				H.lfhole = hole

			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message]</B></font>")
				P.lust += 5
			else
				H.visible_message("<font color=purple>[H] [message]</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message]</font>")
			if (P.stat != DEAD && P.stat != UNCONSCIOUS)
				P.lust += 5
				if (P.lust >= P.resistenza)
					P.cum(P, H)
					timeofact = world.time
					message = pick("кончает [H] в руку.", "кончает в сжатый кулачок [H].", "разбрызгивает сем[ya], пачка[ya] ладошку и пальцы [H].", "кончает на пол.", "стрел[ya]ет тугой струЄй малафьи, зал[ya]пыва[ya] [H].")
					P.visible_message("<B>[P]</B> [message]")
					playsound(loc, "honk/sound/interactions/final_m[rand(1, 5)].ogg", 70, 1, frequency = get_age_pitch())
					P.lust = 0
					P.druggy = 60
				else
					P.moan()
			playsound(loc, "honk/sound/interactions/champ_fingering.ogg", 50, 1, -1)
			H.do_fucking_animation(P)

		if("blowjob")

			switch(H.species.name)
				if("Human", "Skrell", "Vatborn", "Custom Species", "Rapala", "Vasilissan")
					message = pick("отсасывает [P].", "сосет член [P].", "стимулирует член [P] [ya]зыком.")
					if (prob(35))
						message = pick("целует орган [P], прикрыв глаза от удовольстви[ya].", "постанывает, прикрыв глаза, не вынима[ya] член [P] изо рта.", "ласкает член [P] [ya]зычком, придержива[ya] его рукой.", "облизывает член [P] по всей длине.", "погружает член [P] все глубже себе в рот.", "кончиком [ya]зыка облизывает головку члена [P].", "плюЄт на кончик члена [P] и снова берЄт его в рот.", "сосЄт леденец [P].", "двигает головой взад-вперЄд, стимулиру[ya] член [P].", "тщательно вылизывает член [P].", "зажмурившись, полностью заглатывает малыша [P].", "ласкает член [P], помога[ya] себе руками.")
					if (H.lastfucked != P || H.lfhole != hole)
						message = pick("м[ya]гко обхватывает член [P] губами.", "приступает сосать член [P].")
						H.lastfucked = P
						H.lfhole = hole

				if("Unathi", "Akula", "Sergal", "Teshari")
					message = pick("облизывает член [P].", "стимулирует орган [P] [ya]зыком.", "трЄт член [P] о свой [ya]зык.", "проталкивает член [P] себе в пасть, стара[ya]сь не зацепить его зубами.", "стимулирует член [P] [ya]зыком.")
					if (prob(35))
						message = pick("облизывает орган [P], прикрыв глаза от удовольстви[ya].", "постанывает, прикрыв глаза, не вынима[ya] член [P] из пасти.", "ласкает член [P] [ya]зычком, придержива[ya] его рукой.", "облизывает член [P] по всей длине.", "погружает член [P] все глубже себе в пасть.", "кончиком [ya]зыка облизывает головку члена [P].", "плюЄт на кончик члена [P] и проталкивает его себе в глотку.", "облизывает леденец [P].", "двигает головой взад-вперЄд, стимулиру[ya] член [P].", "тщательно вылизывает член [P].", "зажмурившись, полностью заглатывает малыша [P].", "ласкает член [P], помога[ya] себе руками.")
					if (H.lastfucked != P || H.lfhole != hole)
						message = pick("кончиком [ya]зыка касаетс[ya] члена [P].", "приступает облизывать член [P].")
						H.lastfucked = P
						H.lfhole = hole

				if("Tajara", "Vulpkanin", "Flatland Zorren", "Highlander Zorren")
					message = pick("вылизывает член [P].", "обводит своим шершавым [ya]зычком вокруг члена [P].", "проталкивает член [P] себе в пасть, стара[ya]сь не зацепить его зубами.", "стимулирует член [P] [ya]зыком.")
					if (prob(35))
						message = pick("вылизывает орган [P], прикрыв глаза от удовольстви[ya].", "постанывает, прикрыв глаза, не вынима[ya] член [P] из пасти.", "ласкает член [P] [ya]зычком, придержива[ya] его рукой.", "облизывает член [P] по всей длине.", "погружает член [P] все глубже себе в пасть.", "кончиком [ya]зыка облизывает головку члена [P].", "плюЄт на кончик члена [P] и проталкивает его себе в глотку.", "вылизывает леденец [P].", "двигает головой взад-вперЄд, стимулиру[ya] член [P].", "тщательно вылизывает член [P].", "зажмурившись, полностью заглатывает малыша [P].", "ласкает член [P], помога[ya] себе руками.")
					if (H.lastfucked != P || H.lfhole != hole)
						message = pick("кончиком [ya]зыка касаетс[ya] члена [P].", "приступает вылизывать член [P].")
						H.lastfucked = P
						H.lfhole = hole

				if("Vox", "Nevrean")
					message = pick("облизывает член [P].", "стимулирует орган [P] [ya]зыком.", "трЄт член [P] о свой [ya]зык.", "проталкивает член [P] себе в глотку, стара[ya]сь не зацепить его клювом.", "стимулирует член [P] [ya]зыком.")
					if (prob(35))
						message = pick("облизывает орган [P], прикрыв глаза от удовольстви[ya].", "постанывает, прикрыв глаза, не вынима[ya] член [P] из клюва.", "ласкает член [P] [ya]зычком, придержива[ya] его крылом.", "облизывает член [P] по всей длине.", "погружает член [P] все глубже себе в клюв.", "кончиком [ya]зыка облизывает головку члена [P].", "плюЄт на кончик члена [P] и проталкивает его себе в глотку.", " облизывает леденец [P].", "двигает головой взад-вперЄд, стимулиру[ya] член [P].", "тщательно вылизывает член [P].", "зажмурившись, полностью заглатывает малыша [P].", "ласкает член [P] [ya]зыком.")
					if (H.lastfucked != P || H.lfhole != hole)
						message = pick("кончиком [ya]зыка касаетс[ya] члена [P].", "приступает облизывать член [P].")
						H.lastfucked = P
						H.lfhole = hole

				if("Promethean")
					message = pick("отсасывает [P].", "сосет член [P].", "стимулирует член [P] [ya]зыком.")
					if (prob(35))
						message = pick("смачно целует орган [P], прикрыв глаза от удовольстви[ya].", "постанывает, прикрыв глаза, не вынима[ya] член [P] изо рта.", "ласкает член [P] [ya]зычком, покрыва[ya] его в[ya]зкой слизью.", "облизывает член [P] по всей длине, оставл[ya][ya] след из слизи.", "погружает член [P] все глубже себе в рот.", "кончиком [ya]зыка облизывает головку члена [P].", "смачивает кончик члена [P] липкой слизью и снова берЄт его в рот.", "сосет леденец [P].", "двигает головой взад-вперЄд, стимулиру[ya] член [P].", "тщательно вылизывает член [P].", "зажмурившись, полностью заглатывает малыша [P].", "ласкает член [P], помога[ya] себе руками.")
					if (H.lastfucked != P || H.lfhole != hole)
						message = pick("м[ya]гко обхватывает член [P] губами, обволакива[ya] его слизью.", "приступает сосать член [P].")
						H.lastfucked = P
						H.lfhole = hole

				if("Diona")
					return

				if("Machine")
					return

			if (H.lust < 6)
				H.lust += 6
			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message]</B></font>")
				P.lust += 10
			else
				H.visible_message("<font color=purple>[H] [message]</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message]</font>")
			if (P.stat != DEAD && P.stat != UNCONSCIOUS)
				P.lust += 10
				if (P.lust >= P.resistenza)
					P.cum(P, H, "mouth")
					timeofact = world.time
					message = pick("кончает [H] в рот.", "целитс[ya] в лицо [H], стрел[ya]ет тугой струЄй малафьи, но промахиваетс[ya].", "разбрызгивает сем[ya] на лицо [H].", "кончает на пол.", "спускает на [ya]зычок [H].")
					P.visible_message("<B>[P]</B> [message]")
					playsound(loc, "honk/sound/interactions/final_m[rand(1, 5)].ogg", 70, 1, frequency = get_age_pitch())
					P.lust = 0
					P.druggy = 60
			playsound(loc, "honk/sound/interactions/bj[rand(1, 11)].ogg", 50, 1, -1)
			H.do_fucking_animation(P)
			if (prob(P.potenzia))
				H.oxyloss += 3
				H.visible_message("<B>[H]</B> [pick("давитс[ya] инструментом <B>[P]</B>", "задыхаетс[ya]", "корчитс[ya] в рвотном позыве")].")
				if (istype(P.loc, /obj/structure/closet))
					P.visible_message("<B>[H]</B> [pick("давитс[ya] инструментом <B>[P]</B>", "задыхаетс[ya]", "корчитс[ya] в рвотном позыве")].")

		if("vaginal")

			message = pick("трахает [P].", "сношает [P].", "долбит [P].")
			if (prob(35))
				switch(P.species.name)
					if("Human", "Skrell", "Vatborn", "Custom Species", "Rapala", "Vasilissan", "Unathi")
						message = pick("грубо трахает [P].", "предаЄтс[ya] страстной любви с [P].", "резким движением погружаетс[ya] внутрь [P].", "движетс[ya] внутри [P].", "двигает тазом, засажива[ya] член в [P].", "стонет, навалива[ya]сь на [P].", "сильно прижимаетс[ya] пахом к [P].", "насаживает [P] на свой член.", "чувственно имеет [P].")
					if("Tajara", "Vulpkanin", "Flatland Zorren", "Highlander Zorren")
						message = pick("грубо трахает [P].", "предаЄтс[ya] страстной любви с [P].", "резким движением погружаетс[ya] внутрь [P].", "движетс[ya] внутри [P].", "двигает тазом, засажива[ya] член в [P].", "стонет, навалива[ya]сь на [P].", "сильно прижимаетс[ya] пахом к [P].", "насаживает [P] на свой член.", "чувственно имеет [P].")
					if("Promethean")
						message = pick("грубо трахает [P].", "предаЄтс[ya] страстной любви с [P].", "резким движением погружаетс[ya] внутрь [P].", "движетс[ya] внутри [P].", "двигает тазом, засажива[ya] член в [P].", "стонет, навалива[ya]сь на [P].", "сильно прижимаетс[ya] пахом к [P].", "насаживает [P] на свой член.", "чувственно имеет [P].")
						playsound(loc, "honk/sound/interactions/champ[rand(1, 2)].ogg", 50, 1, -1)

			if (H.lastfucked != P || H.lfhole != hole)
				message = pick("всаживает свой член по самые [ya]йца в [P].", "вводит свой орган любви в лоно [P].", "погружает свой корень похоти внутрь [P].", "проникает в [P].")
				H.lastfucked = P
				H.lfhole = hole

			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message]</B></font>")
				P.lust += H.potenzia * 2
			else
				H.visible_message("<font color=purple>[H] [message]</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message]</font>")
				playsound(P.loc.loc, 'sound/effects/clang.ogg', 50, 0, 0)
			H.lust += 10
			if (H.lust >= H.resistenza)
				H.cum(H, P, "vagina")
				timeofact = world.time
				message = pick("кончает в [P]", "резко выт[ya]гивает член из [P], а затем спускает на пол.", "проникает в [P] последний раз, затем содрагаетс[ya]. —перма медленно вытекает из щели [P].")
				H.visible_message("<B>[H]</B> [message]")
				playsound(loc, "honk/sound/interactions/final_m[rand(1, 5)].ogg", 70, 1, frequency = get_age_pitch())
				H.lust = 0
				H.druggy = 30
				P.lust += 5

			if (P.stat != DEAD && P.stat != UNCONSCIOUS)
				P.lust += H.potenzia * 0.5
				if (P.lust >= P.resistenza)
					P.cum(P, H)
					message = pick("¬ы чувствуете, как вагинальные мышцы [P] начинают резко сокращатьс[ya] вокруг вашего инструмента.", "¬ы чувствуете, как ребристые стенки [P] крепко сжимают ваш напр[ya]жЄнный член.", "¬ы чувствуете, как влажна[ya] киска [P] резко сжимает ваш член внутри себ[ya].", "¬ы чувствуете, что вашему прибору становитс[ya] тесно внутри гор[ya]чей писечки [P].", "¬ы чувствуете, как мышцы внутри разгор[ya]чЄнной вагины [P] сильно сжимаютс[ya] несколько раз, приближа[ya] вас к оргазму.")
					to_chat(H, message)
				else
					P.moan()
			H.do_fucking_animation(P)
			playsound(loc, "honk/sound/interactions/bang[rand(1, 3)].ogg", 70, 1, -1)

		if("anal")

			message = pick("долбит [P] в очко.", "анально сношает [P].", "трахает [P] в анус.")
			if (prob(35))
				switch(P.species.name)
					if("Human", "Vatborn", "Custom Species", "Rapala", "Vasilissan", "Akula")
						message = pick("трахает [P] в задницу.", "всаживает член [P] в анальное кольцо по самые [ya]йца.", "месит глину в шахте [P].", "разрывает [P] очко бешеными фрикци[ya]ми.", "запускает своего шахтера в угольные шахты [P].")
					if("Unathi")
						message = pick("трахает [P] в клоаку.", "всаживает член [P] в анальное кольцо по самые [ya]йца.", "месит глину в шахте [P].", "разрывает [P] очко бешеными фрикци[ya]ми.", "запускает своего шахтера в угольные шахты [P].")
					if("Tajara", "Vulpkanin", "Flatland Zorren", "Highlander Zorren", "Sergal")
						message = pick("трахает [P] под хвост.", "всаживает член [P] в анальное кольцо по самые [ya]йца.", "долбит [P] под пушистый хвостик.", "месит глину в шахте [P].", "разрывает [P] очко бешеными фрикци[ya]ми.", "запускает своего шахтера в угольные шахты [P].")
					if("Skrell", "Teshari", "Vox", "Nevrean")
						message = pick("трахает [P] в клоаку.", "всаживает член [P] в анальное кольцо по самые [ya]йца.", "месит глину в шахте [P].", "разрывает [P] очко бешеными фрикци[ya]ми.", "запускает своего шахтера в угольные шахты [P].")
					if("Promethean")
						message = pick("трахает [P] в задницу.", "всаживает член [P] в анальное кольцо по самые [ya]йца, л[ya]па[ya]сь в в[ya]зкой слизи.", "раcт[ya]гивает [P] очко бешеными фрикци[ya]ми.")
						playsound(loc, "honk/sound/interactions/champ[rand(1, 2)].ogg", 50, 1, -1)

			if (H.lastfucked != P || H.lfhole != hole)
				message = pick(" безжалостно прорывает анальное отверстие [P].", "всаживает член [P] в очко.")
				H.lastfucked = P
				H.lfhole = hole

			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message]</B></font>")
				P.lust += H.potenzia * 2
			else
				H.visible_message("<font color=purple>[H] [message]</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message]</font>")
				playsound(P.loc.loc, 'sound/effects/clang.ogg', 50, 0, 0)
			H.lust += 12
			if (H.lust >= H.resistenza)
				H.cum(H, P, "anus")
				timeofact = world.time
				message = pick("кончает [P] в зад.", "выдергивает член из [P], а затем обильно кончает на [P.identifying_gender == MALE ? "его" : "еЄ"] попку.", "выт[ya]гивает член из задницы [P] и сразу же спускает на пол.")
				H.visible_message("<B>[H]</B> [message]")
				playsound(loc, "honk/sound/interactions/final_m[rand(1, 5)].ogg", 70, 1, frequency = get_age_pitch())
				H.lust = 0
				H.druggy = 30
				P.lust += 5

			if (P.stat != DEAD && P.stat != UNCONSCIOUS)
				if (H.potenzia > 13)
					P.lust += H.potenzia * 0.25
				else
					P.lust += H.potenzia * 0.75
				if (P.lust >= P.resistenza)
					P.cum(P, H)
				else
					P.moan()
			H.do_fucking_animation(P)
			playsound(loc, "honk/sound/interactions/bang[rand(1, 3)].ogg", 70, 1, -1)

		if("oral")

			message = pick(" трахает [P], засажива[ya] свой член [P.identifying_gender == FEMALE ? "ей" : "ему"] в глотку.", " орально сношает [P].")
			if (prob(35))
				switch(P.species.name)
					if("Human", "Skrell", "Vatborn", "Custom Species", "Rapala", "Vasilissan")
						message = pick(" опираетс[ya] на плечи [P], придержива[ya] [P.identifying_gender==FEMALE ? "еЄ" : "его"] и засажива[ya] член всЄ сильнее и сильнее [P.identifying_gender==FEMALE ? "ей" : "ему"] в глотку.", " трахает [P] в рот.", " насаживает голову [P] на свой член.", " держит [P] за голову двум[ya] руками и совершает движени[ya] тазом.", " даЄт пощЄчины [P], продолжа[ya] ебать жертву в рот.", " безжастно пользуетс[ya] глоткой [P].", ", рыча сквозь зубы, нат[ya]гивает глотку [P] на своего малыша.")
					if("Unathi", "Akula", "Sergal", "Teshari")
						message = pick(" опираетс[ya] на плечи [P], придержива[ya] [P.identifying_gender==FEMALE ? "еЄ" : "его"] и засажива[ya] член всЄ сильнее и сильнее [P.identifying_gender==FEMALE ? "ей" : "ему"] в глотку.", " трахает [P] в зубастую пасть.", " насаживает голову [P] на свой член.", " держит [P] за голову двум[ya] руками и совершает движени[ya] тазом.", " даЄт пощЄчины [P], продолжа[ya] ебать [P.identifying_gender == FEMALE ? "бедную [ya]щерку" : "бедного [ya]щера"] в пасть.", " безжастно пользуетс[ya] глоткой [P].", ", рыча сквозь зубы, нат[ya]гивает глотку [P] на своего малыша.")
					if("Tajara", "Vulpkanin", "Flatland Zorren", "Highlander Zorren")
						message = pick(" опираетс[ya] на плечи [P], придержива[ya] [P.identifying_gender==FEMALE ? "еЄ" : "его"] и засажива[ya] член всЄ сильнее и сильнее [P.identifying_gender==FEMALE ? "ей" : "ему"] в глотку.", " трахает [P] в зубастую пасть.", " насаживает голову [P] на свой член.", " держит [P] за голову двум[ya] руками и совершает движени[ya] тазом.", " даЄт пощЄчины [P], продолжа[ya] ебать [P.identifying_gender == FEMALE ? "бедную кошечку" : "бедного котЄнка"] в пасть.", " безжастно пользуетс[ya] глоткой [P].", ", рыча сквозь зубы, нат[ya]гивает глотку [P] на своего малыша.")
					if("Vox", "Nevrean")
						message = pick(" опираетс[ya] на плечи [P], придержива[ya] [P.identifying_gender==FEMALE ? "еЄ" : "его"] и засажива[ya] член всЄ сильнее и сильнее [P.identifying_gender==FEMALE ? "ей" : "ему"] в глотку.", " трахает [P] пр[ya]мо в клюв.", " насаживает голову [P] на свой член, стара[ya]сь не порезатьс[ya] о выступы на клюве.", " держит [P] за голову двум[ya] руками и совершает движени[ya] тазом.", " сжимает перь[ya] на голове [P], продолжа[ya] ебать бедную птичку в рот.", " безжастно пользуетс[ya] глоткой [P].", ", рыча сквозь зубы, нат[ya]гивает глотку [P] на своего малыша.")
					if("Promethean")
						message = pick(" опираетс[ya] на желеобразные плечи [P], придержива[ya] [P.identifying_gender==FEMALE ? "еЄ" : "его"] и засажива[ya] член всЄ сильнее и сильнее [P.identifying_gender==FEMALE ? "ей" : "ему"] в глотку.", " трахает [P] в рот, зал[ya]пыва[ya] свой член в липкой слизи.", " насаживает голову [P] на свой член.", " держит [P] за голову двум[ya] руками и совершает движени[ya] тазом.", " продолжает ебать [P.identifying_gender == FEMALE ? "бедную слизнедевку" : "бедного слизн[ya]"] в рот.", " безжастно пользуетс[ya] ротиком [P].", ", черезмерно увлекшись, тыкает членом мимо рта [P] и дрожит от внезапных ощущений.", " нещадно насилует глотку [P].")

			if (H.lastfucked != P || H.lfhole != hole)
				message = pick(" бесцеремонно проталкивает свой член [P] в глотку.")
				H.lastfucked = P
				H.lfhole = hole

			if (prob(5) && H.stat != DEAD)
				H.visible_message("<font color=purple><B>[H][message]</B></font>")
				H.lust += 15
			else
				H.visible_message("<font color=purple>[H][message]</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H][message]</font>")
				playsound(P.loc.loc, 'sound/effects/clang.ogg', 50, 0, 0)
			H.lust += 15
			if (H.lust >= H.resistenza)
				H.cum(H, P, "mouth")
				timeofact = world.time
				message = pick("кончает [P] в рот.", "целитс[ya] в лицо [P], стрел[ya]ет тугой струЄй малафьи, но промахиваетс[ya].", "разбрызгивает сем[ya] на лицо [P].", "кончает на пол.", "спускает на [ya]зычок [P].")
				H.visible_message("<B>[H]</B> [message]")
				playsound(loc, "honk/sound/interactions/final_m[rand(1, 5)].ogg", 70, 1, frequency = get_age_pitch())
				H.lust = 0
				H.druggy = 30

			H.do_fucking_animation(P)
			playsound(loc, "honk/sound/interactions/oral[rand(1, 2)].ogg", 70, 1, -1)
			if (P.species.name == "Promethean")
				playsound(loc, "honk/sound/interactions/champ[rand(1, 2)].ogg", 50, 1, -1)
			if (prob(H.potenzia))
				P.oxyloss += 3
				H.visible_message("<B>[P]</B> [pick("давитс[ya] инструментом <B>[H]</B>", "задыхаетс[ya]", "корчитс[ya] в рвотном позыве")].")
				if (istype(P.loc, /obj/structure/closet))
					P.visible_message("<B>[P]</B> [pick("давитс[ya] инструментом <B>[H]</B>", "задыхаетс[ya]", "корчитс[ya] в рвотном позыве")].")


		if("mount")

			message = pick("скачет на члене [P]", "прыгает на инструменте [P]", "насаживаетс[ya] на [P]")
			if (prob(35))
				message = pick("седлает тело [P], словно наездница", "скачет на малыше [P]", "прыгает на [P], удар[ya][ya]сь о его тело", "радостно подпрыгивает, доставл[ya][ya] удовольствие себе и [P]", "уперлась тазом в [P] и елозит, держа его член внутри", "двигает тазом по-кругу, сид[ya] на инструменте [P]", "вприпрыжку наваливаетс[ya] на [P], вз[ya]в внутрь его член", "набрасывает своЄ лоно на крючок [P], дав[ya] на него своим тазом", "впускает внутрь себ[ya] зверька [P]")

			if (H.lastfucked != P || H.lfhole != hole)
				message = pick("осторожно насаживаетс[ya] на половой орган [P]", "направл[ya]ет член [P] в свою влажную киску, помога[ya] себе рукой", "медленно вводит в себ[ya] ствол [P]")
				H.lastfucked = P
				H.lfhole = hole

			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message].</B></font>")
				P.lust += H.potenzia * 2
			else
				H.visible_message("<font color=purple>[H] [message].</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message].</font>")
				playsound(P.loc.loc, 'sound/effects/clang.ogg', 50, 0, 0)
			H.lust += P.potenzia
			if (H.lust >= H.resistenza)
				H.cum(H, P)
				H.lust = 0
				message = pick("¬ы чувствуете, как вагинальные мышцы [H] начинают резко сокращатьс[ya] вокруг вашего инструмента.", "¬ы чувствуете, как ребристые стенки [H] крепко сжимают ваш напр[ya]жЄнный член.", "¬ы чувствуете, как влажна[ya] киска [H] резко сжимает ваш член внутри себ[ya].", "¬ы чувствуете, что вашему прибору становитс[ya] тесно внутри гор[ya]чей писечки [H].", "¬ы чувствуете, как мышцы внутри разгор[ya]чЄнной вагины [H] сильно сжимаютс[ya] несколько раз, приближа[ya] вас к оргазму.")
				to_chat(P, message)
				P.lust += 15
			else
				H.moan()
			if (P.stat != DEAD && P.stat != UNCONSCIOUS)
				P.lust += H.potenzia
				if (P.lust >= P.resistenza)
					P.cum(P, H, "vagina")
					timeofact = world.time
					message = pick("кончает в [H]", "резко выт[ya]гивает член из [H], а затем спускает на пол.", "проникает в [H] последний раз, затем содрагаетс[ya]. —перма медленно вытекает из щели [H].")
					P.visible_message("<B>[P]</B> [message]")
					playsound(loc, "honk/sound/interactions/final_m[rand(1, 5)].ogg", 70, 1, frequency = get_age_pitch())
					P.lust = 0
					P.druggy = 30
				else
					P.moan()
			H.do_fucking_animation(P)
			playsound(loc, "honk/sound/interactions/bang[rand(1, 3)].ogg", 70, 1, -1)
			if (H.species.name == "Promethean")
				playsound(loc, "honk/sound/interactions/champ[rand(1, 2)].ogg", 50, 1, -1)

		if("rub")

			message = pick("трЄтс[ya] о член [P]", "трЄтс[ya] об инструмент [P]", "стимулирует член [P] своей киской")
			if (prob(35))
				message = pick("елозит половыми губами по члену [P] в позе наездницы", "натирает малыша [P], крепко уперевшись тазом", "в ускоренном темпе совершает фрикции, натира[ya] клитор о член [P]", "трахает половой орган, прижатый к животу [P.identifying_gender==FEMALE ? "партнЄрши" : "партнЄра"], доставл[ya][ya] удовольствие себе и [P]", "уперлась тазом в [P] и елозит", "двигает тазом по-кругу, трением стимулиру[ya] инструмент [P]", "водит головкой члена [P] между половых губ, помога[ya] себе рукой", "трЄт крючок [P] на месте, дав[ya] на него своим тазом", "стимулирует клитор о зверька [P]")

			if (H.lastfucked != P || H.lfhole != hole)
				message = pick("осторожно садитс[ya] промежностью на половой орган, прижима[ya] его к животу [P]", "придерживает член [P] рукой в положении у живота [P.identifying_gender==FEMALE ? "партнЄрши" : "партнЄра"], после чего садитс[ya] влажной писечкой на ствол", "медленно садитс[ya] на [P] и зажимает его член между своих половых губ")
				H.lastfucked = P
				H.lfhole = hole

			if (prob(5) && P.stat != DEAD)
				H.visible_message("<font color=purple><B>[H] [message].</B></font>")
				P.lust += H.potenzia * 2
			else
				H.visible_message("<font color=purple>[H] [message].</font>")
			if (istype(P.loc, /obj/structure/closet))
				P.visible_message("<font color=purple>[H] [message].</font>")
				playsound(P.loc.loc, 'sound/effects/clang.ogg', 50, 0, 0)
			H.lust += 9
			if (H.lust >= H.resistenza)
				H.cum(H, P)
				H.lust = 0
			else
				H.moan()
			if (P.stat != DEAD && P.stat != UNCONSCIOUS)
				P.lust += 10
				if (P.lust >= P.resistenza)
					P.cum(P, H, "vagina")
					timeofact = world.time
					message = pick("кончает себе на живот.", "целитс[ya] на живот [H], стрел[ya]ет тугой струЄй малафьи, но промахиваетс[ya].", "разбрызгивает сем[ya] по пузику [H].", "заполн[ya]ет внешнюю часть вагины [H] гор[ya]чей спермой.")
					P.visible_message("<B>[P]</B> [message]")
					playsound(loc, "honk/sound/interactions/final_m[rand(1, 5)].ogg", 70, 1, frequency = get_age_pitch())
					P.lust = 0
					P.druggy = 30
				else
					P.moan()
			H.do_fucking_animation(P)
			playsound(loc, "honk/sound/interactions/champ_fingering.ogg", 50, 1, -1)

mob/living/carbon/human/proc/moan()
	var/ya = "&#255;"
	var/mob/living/carbon/human/H = src
	switch(species.name)
		if("Human", "Skrell", "Vatborn", "Custom Species", "Rapala", "Vasilissan", "Akula", "Promethean", "Tajara", "Vulpkanin", "Sergal", "Flatland Zorren", "Highlander Zorren")
			if (prob(H.lust / H.resistenza * 65))
				var/message = pick("постанывает", "стонет от удовольстви[ya]", "закатывает глаза", "закусывает губу", "довольно облизываетс[ya]")
				H.visible_message("<B>[H]</B> [message].")
				var/g = H.gender == FEMALE ? "f" : "m"
				var/moan = rand(1, 7)
				if (moan == lastmoan)
					moan--
				if(!istype(loc, /obj/structure/closet))
					playsound(loc, "honk/sound/interactions/moan_[g][moan].ogg", 70, 1, frequency = get_age_pitch())
				else if (g == "f")
					playsound(loc, "honk/sound/interactions/under_moan_f[rand(1, 4)].ogg", 70, 1, frequency = get_age_pitch())
				lastmoan = moan

				if (istype(H.head, /obj/item/clothing/head/kitty)  || istype(H.head, /obj/item/clothing/head/collectable/kitty))
					playsound(loc, "honk/sound/interactions/purr_f[rand(1, 3)].ogg", 70, 1, 0)
/*
		if("Tajara")
			if (prob(H.lust / src.resistenza * 70))
				var/message = pick("мурлычет", "мурлычет от удовольстви[ya]", "закатывает глаза", "довольно облизываетс[ya]")
				H.visible_message("<B>[H]</B> [message].")
				playsound(loc, "honk/sound/interactions/purr[rand(1, 3)].ogg", 70, 1, frequency = get_age_pitch())

		if("Vulpkanin", "Sergal", "Flatland Zorren", "Highlander Zorren")
			if (prob(H.lust / src.resistenza * 70))
				var/message = pick("поскуливает", "поскуливает от удовольстви[ya]", "закатывает глаза", "довольно облизываетс[ya]")
				H.visible_message("<B>[H]</B> [message].")
*/
		if("Unathi")
			if (prob(H.lust / H.resistenza * 70))
				var/message = pick("довольно шипит", "извиваетс[ya] от удовольстви[ya]")
				H.visible_message("<B>[H]</B> [message].")

		if("Teshari", "Vox", "Nevrean")
			if (prob(H.lust / H.resistenza * 70))
				var/message = pick("довольно стрекочет", "извиваетс[ya] от удовольстви[ya]")
				H.visible_message("<B>[H]</B> [message].")


mob/living/carbon/human/proc/handle_lust()
	lust -= 4
	if (lust <= 0)
		lust = 0
		lastfucked = null
		lfhole = ""
		multiorgasms = 0
	if (lust == 0)
		erpcooldown -= 1
	if (erpcooldown < 0)
		erpcooldown = 0

/mob/living/carbon/human/proc/do_fucking_animation(mob/living/carbon/human/P)
	var/pixel_x_diff = 0
	var/pixel_y_diff = 0
	var/final_pixel_y = initial(pixel_y)

	var/direction = get_dir(src, P)
	if(direction & NORTH)
		pixel_y_diff = 8
	else if(direction & SOUTH)
		pixel_y_diff = -8

	if(direction & EAST)
		pixel_x_diff = 8
	else if(direction & WEST)
		pixel_x_diff = -8

	if(pixel_x_diff == 0 && pixel_y_diff == 0)
		pixel_x_diff = rand(-3,3)
		pixel_y_diff = rand(-3,3)
		animate(src, pixel_x = pixel_x + pixel_x_diff, pixel_y = pixel_y + pixel_y_diff, time = 2)
		animate(pixel_x = initial(pixel_x), pixel_y = initial(pixel_y), time = 2)
		return

	animate(src, pixel_x = pixel_x + pixel_x_diff, pixel_y = pixel_y + pixel_y_diff, time = 2)
	animate(pixel_x = initial(pixel_x), pixel_y = final_pixel_y, time = 2)

/obj/item/weapon/enlarger
	name = "penis enlarger"
	desc = "Very special DNA mixture which helps YOU to enlarge your little captain."
	icon = 'icons/obj/items.dmi'
	icon_state = "dnainjector"
	item_state = "dnainjector"
	hitsound = null
	throwforce = 0
	w_class = 1
	throw_speed = 3
	throw_range = 15
	attack_verb = list("stabbed")

/obj/item/weapon/enlarger/attack(mob/living/carbon/human/M, mob/living/carbon/human/user)
	if(istype(M, /mob/living/carbon/human) && (M.gender == MALE))
		M.potenzia = 30
		to_chat(user, "<span class='warning'>Your penis extends!</span>")

	else if (istype(M, /mob/living/carbon/human) && M.gender == FEMALE)
		to_chat(user, "<span class='warning'>It didn't affect you since you're female!</span>")

	..()

	qdel(src)

/obj/item/weapon/enlarger/attack_self(mob/user as mob)
	to_chat(user, "<span class='warning'>You break the syringe. Gooey mass is dripping on the floor.</span>")
	qdel(src)

/obj/item/weapon/dildo
	name = "dildo"
	desc = "Hm-m-m, deal thow"
	icon = 'honk/icons/obj/items/dildo.dmi'
	icon_state = "dildo"
	item_state = "c_tube"
	throwforce = 0
	force = 10
	w_class = 1
	throw_speed = 3
	throw_range = 15
	attack_verb = list("slammed", "bashed", "whipped")
	var/hole = "vagina" //or "anus"
	var/rus_name = "дилдо"
	var/ya = "&#255;"
	var/pleasure = 10

/obj/item/weapon/dildo/attack(mob/living/carbon/human/M, mob/living/carbon/human/user)
	var/hasvagina = (M.gender == FEMALE && M.species.genitals && M.species.name != "Unathi" && M.species.name != "Stok")
	var/hasanus = M.species.anus
	var/message = ""

	if(istype(M, /mob/living/carbon/human) && user.zone_sel.selecting == "groin" && M.is_nude())
		if (hole == "vagina" && hasvagina)
			if (user == M)
				message = pick("удовлетвор[ya]ет себ[ya] с помощью [rus_name]", "заталкивает в себ[ya] [rus_name]", "погружает [rus_name] в свое лоно")
			else
				message = pick("удовлетвор[ya]ет [M] с помощью [rus_name]", "заталкивает в [M] [rus_name]", "погружает [rus_name] в лоно [M]")

			if (prob(5) && M.stat != DEAD && M.stat != UNCONSCIOUS)
				user.visible_message("<font color=purple><B>[user] [message].</B></font>")
				M.lust += pleasure * 2

			else if (M.stat != DEAD && M.stat != UNCONSCIOUS)
				user.visible_message("<font color=purple>[user] [message].</font>")
				M.lust += pleasure

			if (M.lust >= M.resistenza)
				M.cum(M, user, "floor")
			else
				M.moan()

			user.do_fucking_animation(M)
			playsound(loc, "honk/sound/interactions/bang[rand(4, 6)].ogg", 70, 1, -1)

		else if (hole == "anus" && hasanus)
			if (user == M)
				message = pick("удовлетвор[ya]ет себ[ya] анально с помощью [rus_name]", "заталкивает [rus_name] себе в анус", "чистит свой дымоход, использу[ya] [rus_name]")
			else
				message = pick("удовлетвор[ya]ет [M] анально с помощью [rus_name]", "заталкивает [rus_name] [M] в анус", "чистит дымоход [M], использу[ya] [rus_name]")

			if (prob(5) && M.stat != DEAD && M.stat != UNCONSCIOUS)
				user.visible_message("<font color=purple><B>[user] [message].</B></font>")
				M.lust += pleasure * 2

			else if (M.stat != DEAD && M.stat != UNCONSCIOUS)
				user.visible_message("<font color=purple>[user] [message].</font>")
				M.lust += pleasure

			if (M.lust >= M.resistenza)
				M.cum(M, user, "floor")
			else
				M.moan()

			user.do_fucking_animation(M)
			playsound(loc, "honk/sound/interactions/bang[rand(4, 6)].ogg", 70, 1, -1)

		else
			..()
	else
		..()

/obj/item/weapon/dildo/attack_self(mob/user as mob)
	if(hole == "vagina")
		hole = "anus"
	else
		hole = "vagina"
	to_chat(user, "<span class='warning'>Hm-m-m. Maybe we should put it in [hole]?!</span>")
